{
  "version": 3,
  "sources": ["../../src/managers/internal/UIBaseManager/UIBaseManager.ts"],
  "sourcesContent": ["import { UITagsEnum } from 'constants/UITags.enum';\nimport { IEventBus } from 'lib/sdkDappUi';\nimport { ProviderErrorsEnum } from 'types/provider.types';\nimport {\n  ComponentFactory,\n  CreateEventBusUIElementType\n} from 'utils/ComponentFactory';\n\nexport abstract class UIBaseManager<\n  TElement extends CreateEventBusUIElementType,\n  TData extends Record<string, any> | null,\n  TEventEnum extends string\n> {\n  protected eventBus: IEventBus | null = null;\n  protected uiElement: TElement | null = null;\n  protected isCreatingElement = false;\n  protected anchor?: HTMLElement;\n  protected uiTag: UITagsEnum;\n  protected uiDataUpdateEvent: TEventEnum;\n  protected unsubscribeFunctions: Map<TEventEnum, (() => void)[]> = new Map();\n  protected abstract initialData: TData;\n  protected data: TData;\n\n  constructor({\n    uiDataUpdateEvent,\n    uiTag\n  }: {\n    uiTag: UITagsEnum;\n    uiDataUpdateEvent: TEventEnum;\n  }) {\n    this.uiDataUpdateEvent = uiDataUpdateEvent;\n    this.uiTag = uiTag;\n    this.data = this.getInitialData();\n  }\n\n  public async init(anchor?: HTMLElement) {\n    this.anchor = anchor;\n    await this.createUIElement(anchor);\n    await this.setupEventListeners();\n  }\n\n  public updateData(newData: Partial<TData>) {\n    this.data = { ...this.data, ...newData };\n    this.notifyDataUpdate();\n  }\n\n  public subscribeToEventBus(event: TEventEnum, callback: Function) {\n    if (!this.eventBus) {\n      throw new Error(ProviderErrorsEnum.eventBusError);\n    }\n\n    const unsubscribe = this.eventBus?.subscribe(event, callback);\n    if (unsubscribe) {\n      const existing = this.unsubscribeFunctions.get(event) || [];\n      existing.push(unsubscribe);\n      this.unsubscribeFunctions.set(event, existing);\n    }\n  }\n\n  public notifyDataUpdate() {\n    this.eventBus?.publish(this.uiDataUpdateEvent, this.data);\n  }\n\n  public destroy() {\n    this.unsubscribeFunctions.forEach((unsubList) =>\n      unsubList.forEach((unsubscribe) => unsubscribe())\n    );\n    this.unsubscribeFunctions.clear();\n    this.eventBus = null;\n    this.uiElement?.remove?.();\n    this.uiElement = null;\n  }\n\n  protected getInitialData(): TData {\n    return this.initialData;\n  }\n\n  protected resetData() {\n    this.data = this.getInitialData();\n  }\n\n  protected abstract setupEventListeners(): Promise<void>;\n\n  private async createUIElement(\n    anchor: HTMLElement | undefined = this.anchor\n  ): Promise<TElement | null> {\n    if (this.isCreatingElement || this.uiElement) {\n      return this.uiElement;\n    }\n\n    this.isCreatingElement = true;\n\n    this.uiElement = await ComponentFactory.create<TElement>({\n      name: this.uiTag,\n      anchor\n    });\n\n    this.isCreatingElement = false;\n\n    if (!this.uiElement) {\n      throw new Error(`Failed to create ${this.uiTag} element`);\n    }\n\n    if (!this.eventBus) {\n      this.eventBus = await this.uiElement.getEventBus();\n    }\n\n    if (!this.eventBus) {\n      throw new Error(ProviderErrorsEnum.eventBusError);\n    }\n\n    return this.uiElement;\n  }\n}\n"],
  "mappings": "yCAQO,IAAeA,EAAf,KAIL,CAWA,YAAY,CACV,kBAAAC,EACA,MAAAC,CACF,EAGG,CAhBH,KAAU,SAA6B,KACvC,KAAU,UAA6B,KACvC,KAAU,kBAAoB,GAI9B,KAAU,qBAAwD,IAAI,IAWpE,KAAK,kBAAoBD,EACzB,KAAK,MAAQC,EACb,KAAK,KAAO,KAAK,eAAe,CAClC,CAEA,MAAa,KAAKC,EAAsB,CACtC,KAAK,OAASA,EACd,MAAM,KAAK,gBAAgBA,CAAM,EACjC,MAAM,KAAK,oBAAoB,CACjC,CAEO,WAAWC,EAAyB,CACzC,KAAK,KAAO,CAAE,GAAG,KAAK,KAAM,GAAGA,CAAQ,EACvC,KAAK,iBAAiB,CACxB,CAEO,oBAAoBC,EAAmBC,EAAoB,CAChE,GAAI,CAAC,KAAK,SACR,MAAM,IAAI,mCAAsC,EAGlD,IAAMC,EAAc,KAAK,UAAU,UAAUF,EAAOC,CAAQ,EAC5D,GAAIC,EAAa,CACf,IAAMC,EAAW,KAAK,qBAAqB,IAAIH,CAAK,GAAK,CAAC,EAC1DG,EAAS,KAAKD,CAAW,EACzB,KAAK,qBAAqB,IAAIF,EAAOG,CAAQ,CAC/C,CACF,CAEO,kBAAmB,CACxB,KAAK,UAAU,QAAQ,KAAK,kBAAmB,KAAK,IAAI,CAC1D,CAEO,SAAU,CACf,KAAK,qBAAqB,QAASC,GACjCA,EAAU,QAASF,GAAgBA,EAAY,CAAC,CAClD,EACA,KAAK,qBAAqB,MAAM,EAChC,KAAK,SAAW,KAChB,KAAK,WAAW,SAAS,EACzB,KAAK,UAAY,IACnB,CAEU,gBAAwB,CAChC,OAAO,KAAK,WACd,CAEU,WAAY,CACpB,KAAK,KAAO,KAAK,eAAe,CAClC,CAIA,MAAc,gBACZJ,EAAkC,KAAK,OACb,CAC1B,GAAI,KAAK,mBAAqB,KAAK,UACjC,OAAO,KAAK,UAYd,GATA,KAAK,kBAAoB,GAEzB,KAAK,UAAY,MAAMO,EAAiB,OAAiB,CACvD,KAAM,KAAK,MACX,OAAAP,CACF,CAAC,EAED,KAAK,kBAAoB,GAErB,CAAC,KAAK,UACR,MAAM,IAAI,MAAM,oBAAoB,KAAK,KAAK,UAAU,EAO1D,GAJK,KAAK,WACR,KAAK,SAAW,MAAM,KAAK,UAAU,YAAY,GAG/C,CAAC,KAAK,SACR,MAAM,IAAI,mCAAsC,EAGlD,OAAO,KAAK,SACd,CACF",
  "names": ["UIBaseManager", "uiDataUpdateEvent", "uiTag", "anchor", "newData", "event", "callback", "unsubscribe", "existing", "unsubList", "ComponentFactory"]
}
