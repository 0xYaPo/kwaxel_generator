{
  "version": 3,
  "sources": ["../../../../src/managers/internal/UIBaseManager/UIBaseManager.ts"],
  "sourcesContent": ["import { UITagsEnum } from 'constants/UITags.enum';\nimport { IEventBus } from 'lib/sdkDappUi';\nimport { ProviderErrorsEnum } from 'types/provider.types';\nimport {\n  ComponentFactory,\n  CreateEventBusUIElementType\n} from 'utils/ComponentFactory';\n\nexport abstract class UIBaseManager<\n  TElement extends CreateEventBusUIElementType,\n  TData extends Record<string, any> | null,\n  TEventEnum extends string\n> {\n  protected eventBus: IEventBus | null = null;\n  protected uiElement: TElement | null = null;\n  protected isCreatingElement = false;\n  protected anchor?: HTMLElement;\n  protected uiTag: UITagsEnum;\n  protected uiDataUpdateEvent: TEventEnum;\n  protected unsubscribeFunctions: Map<TEventEnum, (() => void)[]> = new Map();\n  protected abstract initialData: TData;\n  protected data: TData;\n\n  constructor({\n    uiDataUpdateEvent,\n    uiTag\n  }: {\n    uiTag: UITagsEnum;\n    uiDataUpdateEvent: TEventEnum;\n  }) {\n    this.uiDataUpdateEvent = uiDataUpdateEvent;\n    this.uiTag = uiTag;\n    this.data = this.getInitialData();\n  }\n\n  public async init(anchor?: HTMLElement) {\n    this.anchor = anchor;\n    await this.createUIElement(anchor);\n    await this.setupEventListeners();\n  }\n\n  public updateData(newData: Partial<TData>) {\n    this.data = { ...this.data, ...newData };\n    this.notifyDataUpdate();\n  }\n\n  public subscribeToEventBus(event: TEventEnum, callback: Function) {\n    if (!this.eventBus) {\n      throw new Error(ProviderErrorsEnum.eventBusError);\n    }\n\n    const unsubscribe = this.eventBus?.subscribe(event, callback);\n    if (unsubscribe) {\n      const existing = this.unsubscribeFunctions.get(event) || [];\n      existing.push(unsubscribe);\n      this.unsubscribeFunctions.set(event, existing);\n    }\n  }\n\n  public notifyDataUpdate() {\n    this.eventBus?.publish(this.uiDataUpdateEvent, this.data);\n  }\n\n  public destroy() {\n    this.unsubscribeFunctions.forEach((unsubList) =>\n      unsubList.forEach((unsubscribe) => unsubscribe())\n    );\n    this.unsubscribeFunctions.clear();\n    this.eventBus = null;\n    this.uiElement?.remove?.();\n    this.uiElement = null;\n  }\n\n  protected getInitialData(): TData {\n    return this.initialData;\n  }\n\n  protected resetData() {\n    this.data = this.getInitialData();\n  }\n\n  protected abstract setupEventListeners(): Promise<void>;\n\n  private async createUIElement(\n    anchor: HTMLElement | undefined = this.anchor\n  ): Promise<TElement | null> {\n    if (this.isCreatingElement || this.uiElement) {\n      return this.uiElement;\n    }\n\n    this.isCreatingElement = true;\n\n    this.uiElement = await ComponentFactory.create<TElement>({\n      name: this.uiTag,\n      anchor\n    });\n\n    this.isCreatingElement = false;\n\n    if (!this.uiElement) {\n      throw new Error(`Failed to create ${this.uiTag} element`);\n    }\n\n    if (!this.eventBus) {\n      this.eventBus = await this.uiElement.getEventBus();\n    }\n\n    if (!this.eventBus) {\n      throw new Error(ProviderErrorsEnum.eventBusError);\n    }\n\n    return this.uiElement;\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,sBAAmC;AACnC,8BAGO;AAEA,MAAe,cAIpB;AAAA,EAWA,YAAY;AAAA,IACV;AAAA,IACA;AAAA,EACF,GAGG;AAhBH,SAAU,WAA6B;AACvC,SAAU,YAA6B;AACvC,SAAU,oBAAoB;AAI9B,SAAU,uBAAwD,oBAAI,IAAI;AAWxE,SAAK,oBAAoB;AACzB,SAAK,QAAQ;AACb,SAAK,OAAO,KAAK,eAAe;AAAA,EAClC;AAAA,EAEA,MAAa,KAAK,QAAsB;AACtC,SAAK,SAAS;AACd,UAAM,KAAK,gBAAgB,MAAM;AACjC,UAAM,KAAK,oBAAoB;AAAA,EACjC;AAAA,EAEO,WAAW,SAAyB;AACzC,SAAK,OAAO,EAAE,GAAG,KAAK,MAAM,GAAG,QAAQ;AACvC,SAAK,iBAAiB;AAAA,EACxB;AAAA,EAEO,oBAAoB,OAAmB,UAAoB;AAChE,QAAI,CAAC,KAAK,UAAU;AAClB,YAAM,IAAI,MAAM,mCAAmB,aAAa;AAAA,IAClD;AAEA,UAAM,cAAc,KAAK,UAAU,UAAU,OAAO,QAAQ;AAC5D,QAAI,aAAa;AACf,YAAM,WAAW,KAAK,qBAAqB,IAAI,KAAK,KAAK,CAAC;AAC1D,eAAS,KAAK,WAAW;AACzB,WAAK,qBAAqB,IAAI,OAAO,QAAQ;AAAA,IAC/C;AAAA,EACF;AAAA,EAEO,mBAAmB;AACxB,SAAK,UAAU,QAAQ,KAAK,mBAAmB,KAAK,IAAI;AAAA,EAC1D;AAAA,EAEO,UAAU;AACf,SAAK,qBAAqB;AAAA,MAAQ,CAAC,cACjC,UAAU,QAAQ,CAAC,gBAAgB,YAAY,CAAC;AAAA,IAClD;AACA,SAAK,qBAAqB,MAAM;AAChC,SAAK,WAAW;AAChB,SAAK,WAAW,SAAS;AACzB,SAAK,YAAY;AAAA,EACnB;AAAA,EAEU,iBAAwB;AAChC,WAAO,KAAK;AAAA,EACd;AAAA,EAEU,YAAY;AACpB,SAAK,OAAO,KAAK,eAAe;AAAA,EAClC;AAAA,EAIA,MAAc,gBACZ,SAAkC,KAAK,QACb;AAC1B,QAAI,KAAK,qBAAqB,KAAK,WAAW;AAC5C,aAAO,KAAK;AAAA,IACd;AAEA,SAAK,oBAAoB;AAEzB,SAAK,YAAY,MAAM,yCAAiB,OAAiB;AAAA,MACvD,MAAM,KAAK;AAAA,MACX;AAAA,IACF,CAAC;AAED,SAAK,oBAAoB;AAEzB,QAAI,CAAC,KAAK,WAAW;AACnB,YAAM,IAAI,MAAM,oBAAoB,KAAK,KAAK,UAAU;AAAA,IAC1D;AAEA,QAAI,CAAC,KAAK,UAAU;AAClB,WAAK,WAAW,MAAM,KAAK,UAAU,YAAY;AAAA,IACnD;AAEA,QAAI,CAAC,KAAK,UAAU;AAClB,YAAM,IAAI,MAAM,mCAAmB,aAAa;AAAA,IAClD;AAEA,WAAO,KAAK;AAAA,EACd;AACF;",
  "names": []
}
